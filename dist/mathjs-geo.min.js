!function(r,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):r.mathgeo=t()}(this,function(){"use strict";var r=Object.prototype.toString,t=function(t){return Number.isNaN(t)?"NaN":r.call(t).replace(/.*\s(.*)]$/,"$1")},n=function(r,n,e){return!0===e&&"Array"===t(r)?r.every(function(r){return t(r)===n}):t(r)===n},e=function(r){return Math.min.apply(null,r)},a=function(r){return[Math.min.apply(null,r),Math.max.apply(null,r)]},o=function(r){console.error("[MathGeo]: "+r)},u=function(){return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return function(r,t){var n=[],e=!0,a=!1,o=void 0;try{for(var u,i=r[Symbol.iterator]();!(e=(u=i.next()).done)&&(n.push(u.value),!t||n.length!==t);e=!0);}catch(r){a=!0,o=r}finally{try{!e&&i.return&&i.return()}finally{if(a)throw o}}return n}(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){for(var r=arguments.length,t=Array(r),e=0;e<r;e++)t[e]=arguments[e];if(!t.length)return o("add(sub) function need params."),0;var a=new Array(t.length),i=!0,f=!1,l=void 0;try{for(var c,p=Object.entries(t)[Symbol.iterator]();!(i=(c=p.next()).done);i=!0){var v=c.value,m=u(v,2),s=m[0],h=m[1];if(!n(h,"Number"))return o("params of add(sub) function should be number."),0;try{a[s]=h.toString().split(".")[1].length}catch(r){a[s]=0}}}catch(r){f=!0,l=r}finally{try{!i&&p.return&&p.return()}finally{if(f)throw l}}var y,d=Math.pow(10,(y=a,Math.max.apply(null,y))),b=0,g=!0,M=!1,w=void 0;try{for(var N,A=t[Symbol.iterator]();!(g=(N=A.next()).done);g=!0){b+=N.value*d}}catch(r){M=!0,w=r}finally{try{!g&&A.return&&A.return()}finally{if(M)throw w}}return b/d},f=function(){for(var r=arguments.length,t=Array(r),n=0;n<r;n++)t[n]=arguments[n];var e=t.map(function(r,t){return t?-r:r});return i.apply(void 0,function(r){if(Array.isArray(r)){for(var t=0,n=Array(r.length);t<r.length;t++)n[t]=r[t];return n}return Array.from(r)}(e))},l=function(){for(var r=arguments.length,t=Array(r),e=0;e<r;e++)t[e]=arguments[e];if(!t.length)return o("multi function need params."),0;var a=new Array(t.length),i=0,f=1,l=!0,c=!1,p=void 0;try{for(var v,m=Object.entries(t)[Symbol.iterator]();!(l=(v=m.next()).done);l=!0){var s=v.value,h=u(s,2),y=h[0],d=h[1];if(!n(d,"Number"))return o("params of multi function should be number."),0;try{a[y]=d.toString().split(".")[1].length}catch(r){a[y]=0}i+=a[y],f*=d*Math.pow(10,a[y])}}catch(r){c=!0,p=r}finally{try{!l&&m.return&&m.return()}finally{if(c)throw p}}return f/Math.pow(10,i)},c=function(){for(var r=arguments.length,t=Array(r),e=0;e<r;e++)t[e]=arguments[e];if(!t.length)return o("div function need params."),0;for(var a=t[0],u=0;u<t.length-1;u++){if(!n(t[u],"Number")||!n(t[u+1],"Number"))return o("params of div function should be number."),0;var i=void 0,f=void 0;try{i=a.toString().split(".")[1].length}catch(r){i=0}try{f=t[u+1].toString().split(".")[1].length}catch(r){f=0}var l=Math.max(i,f);a=a*Math.pow(10,l)/(t[u+1]*Math.pow(10,l))}return a},p=Object.freeze({add:i,sub:f,multi:l,div:c}),v=function(r,t){return!n([r,t],"Number",!0)||t<0?(o("round function params error."),0):parseFloat(Number.prototype.toFixed.call(r,parseInt(t)))},m=Object.freeze({round:v}),s=function(r){var t=u(r,2),e=u(t[0],2),a=e[0],i=e[1],p=u(t[1],2),m=p[0],s=p[1];if(n([a,i,m,s],"Number",!0)){if(a!==m){var h=v(c(f(i,s),f(a,m)),5);return{k:h,b:v(f(i,l(h,a)),5)}}return null}o("getKB function params error.")},h=Object.freeze({pointOnLine:function(r,t,e){var i=u(r,2),l=i[0],p=i[1],v=u(t,2),m=u(v[0],2),s=m[0],h=m[1],y=u(v[1],2),d=y[0],b=y[1];if(!n([l,p,s,h,d,b],"Number",!0))return o("pointOnLine function params error."),!1;var g=a([s,d]),M=a([h,b]);if(e=e||.01,l<g[0]||l>g[1]||p<M[0]||p>M[1])return!1;if(Math.abs(f(h,b))<Math.abs(f(s,d))){var w=[p,l];l=w[0],p=w[1];var N=[h,s];s=N[0],h=N[1];var A=[b,d];d=A[0],b=A[1]}return Math.abs(f(c(f(l,s),f(p,h)),c(f(s,d),f(h,b))))<e||Math.abs(f(c(f(l,d),f(p,b)),c(f(s,d),f(h,b))))<e},getKB:s,getVertical:function(r,t,e){var a=u(r,2),p=a[0],m=a[1],h=u(t,2),y=u(h[0],2),d=y[0],b=y[1],g=u(h[1],2),M=g[0],w=g[1];if(n([p,m,d,b,M,w,e],"Number",!0)){var N=s([[d,b],[M,w]]),A=void 0,x=void 0;if(N)if(N.k){var k=v(-c(1,N.k),5),O=v(f(m,l(k,p)),5),S=v(c(e,2,Math.sqrt(i(1,Math.pow(k,2)))),5);A=[v(f(p,S),3),v(i(p,S),3)],x=A.map(function(r){return v(i(l(k,r),O),3)})}else A=[p,p],x=[f(m,c(e,2)),i(m,c(e,2))];else A=[f(p,c(e,2)),i(p,c(e,2))],x=[m,m];return A.map(function(r,t){return[r,x[t]]})}o("getVertical function params error.")},getParallel:function(r,t,e){var a=u(r,2),p=a[0],m=a[1],h=u(t,2),y=u(h[0],2),d=y[0],b=y[1],g=u(h[1],2),M=g[0],w=g[1];if(n([p,m,d,b,M,w,e],"Number",!0)){var N=s([[d,b],[M,w]]),A=void 0,x=void 0;if(N){var k=v(c(e,2,Math.sqrt(i(1,Math.pow(N.k,2)))),5),O=v(f(m,l(N.k,p)),5);A=[v(f(p,k),3),v(i(p,k),3)],x=A.map(function(r){return v(i(l(N.k,r),O),3)})}else A=[p,p],x=[f(m,c(e,2)),i(m,c(e,2))];return A.map(function(r,t){return[r,x[t]]})}o("getParallel function params error.")},getExtension:function(r,t,e){var a=u(r,2),p=a[0],m=a[1],h=u(t,2),y=u(h[0],2),d=y[0],b=y[1],g=u(h[1],2),M=g[0],w=g[1];if(n([p,m,d,b,M,w,e],"Number",!0)){var N=s([[d,b],[M,w]]),A=void 0,x=void 0;if(N){var k=v(c(e,Math.sqrt(i(1,Math.pow(N.k,2)))),5);A=[v(f(p,k),3),v(i(p,k),3)],x=A.map(function(r){return v(i(l(N.k,r),N.b),3)})}else A=[p,p],x=[f(m,c(e,2)),i(m,c(e,2))];return A.map(function(r,t){return[r,x[t]]})}o("getExtension function params error.")},getAngle:function(r){var t=u(r,2),e=u(t[0],2),a=e[0],i=e[1],p=u(t[1],2),v=p[0],m=p[1];return n([a,i,v,m],"Number",!0)?c(l(Math.atan2(f(a,v),f(i,m)),180),Math.PI):(o("getAngle function params error."),0)},getYFromX:function(r,t){var e=u(t,2),a=u(e[0],2),f=a[0],c=a[1],p=u(e[1],2),m=p[0],h=p[1];if(n([r,f,c,m,h],"Number",!0)){var y=s([[f,c],[m,h]]);return y?v(i(l(y.k,r),y.b),3):null}o("getYFromX function params error.")},getXFromY:function(r,t){var e=u(t,2),a=u(e[0],2),i=a[0],l=a[1],p=u(e[1],2),m=p[0],h=p[1];if(n([r,i,l,m,h],"Number",!0)){var y=s([[i,l],[m,h]]);return y?y.k?v(c(f(r,y.b),y.k),3):null:i}o("getXFromY function params error.")},lineCross:function(r,t){var e=u(r,2),a=u(e[0],2),p=a[0],m=a[1],s=u(e[1],2),h=s[0],y=s[1],d=u(t,2),b=u(d[0],2),g=b[0],M=b[1],w=u(d[1],2),N=w[0],A=w[1];if(n([p,m,h,y,g,M,N,A],"Number",!0)){var x=f(l(f(p,g),f(y,M)),l(f(m,M),f(h,g))),k=f(l(f(p,N),f(y,A)),l(f(m,A),f(h,N)));if(l(x,k)>=0)return!1;var O=f(l(f(g,p),f(A,m)),l(f(M,m),f(N,p))),S=i(O,x,-k);if(l(O,S)>=0)return!1;var j=c(O,f(k,x)),I=l(j,f(h,p)),C=l(j,f(y,m));return[i(p,I),i(m,C)].map(function(r){return v(r,3)})}o("lineCross function params error.")},getClosestPointIdx:function(r,t,a){var l=u(r,2),c=l[0],p=l[1];if(n([c,p,a],"Number",!0)&&Array.isArray(t)&&t.length){var m=t.map(function(r){return v(i(Math.pow(f(r[0],c),2),Math.pow(f(r[1],p),2)),3)}),s=e(m);return s>Math.pow(a,2)?-1:m.findIndex(function(r){return r===s})}return o("getClosestPointIdx function params error."),-1},getClosetLineIdx:function(r,t,a){var p=u(r,2),m=p[0],h=p[1];if(n([m,h,a],"Number",!0)&&Array.isArray(t)&&t.length){var y=t.map(function(r){var t=s([r[0],r[r.length-1]]);if(t){if(t.k){var n=v(-c(1,t.k),5),e=v(f(h,l(n,m)),5),a=v(c(f(e,t.b),f(t.k,n)),5),o=v(i(l(t.k,a),t.b),5);return v(i(Math.pow(f(a,m),2),Math.pow(f(o,h),2)),3)}return v(Math.pow(f(r[0][1],h),2),3)}return v(Math.pow(f(r[0][0],m),2),3)}),d=e(y);return d>Math.pow(a,2)?-1:y.findIndex(function(r){return r===d})}return o("getClosetLineIdx function params error."),-1}});return Object.assign({},p,m,h)});
